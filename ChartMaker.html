<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"><script src="chart.min.js"></script>

    </head>
    <body>
        <div style="width: 600px; height: 400px;">
            <canvas id="chart" width="600" height="400"></canvas>
            <input id="title" placeholder="Insert title" onchange="setTitle()"><br>
            <input id="kolumny" placeholder="How many columns?" onchange="columns()">
            

            <div top=80px; right=0px; >
                <form id="columnInputs"><br>
                    
                </form>
            </div>
        </div>
        <script>
            const backgroundcolor = [];
            const title = [];
            const dane = {
                
                labels: [],
                        
                datasets: [
                    { label: "",
                      data: [0,0,0,0,0,0,0,0,0,0],
                      backgroundColor: backgroundcolor,}
                      
                ],
            }
            const options={
                plugins:    {
                    title: {display: true,
                            text: title },
                    legend: {position: "bottom"}
                    }
            }
            const ctx = document.getElementById("chart").getContext("2d");
            const chart = new Chart(ctx, { type: "bar", data: dane, options:options });


            function setTitle(){
                let t = (document.getElementById("title").value);
                title.push(t);
                chart.update();
            }

            function columns(){ // Creating columns(amount is given by the user)
                let kol = parseInt(document.getElementById("kolumny").value);
                
                let etykiety=[];
                chart.data.labels=etykiety;
                for(let i=0;i<kol;i++){
                    chart.data.labels[i]="0";

                }

                for(let x=0;x<etykiety.length;x++){ // adding random color for every column
                    var r = Math.floor(Math.random() * 255); 
                    var g = Math.floor(Math.random() * 255);
                    var b = Math.floor(Math.random() * 255);
                    backgroundcolor.push(('rgba('+r+','+g+','+b+', 0.4)'))
                }
                
                chart.update(); 
                Inputs() 
            }

            function Inputs(){ // Fields for entering values to the columns
                document.getElementById("columnInputs").innerHTML = "Insert column values";

                var no = document.getElementById("kolumny").value;
                var j=1;
                for(let i=0;i<no;i++){
                    var field = document.createElement("input");
                    field.type = "text";
                    field.id = "inputs"+ j;
                    field.value = "";
                    field.placeholder= "Column "+j;
                    field.addEventListener("focusout", addValue);
                    document.getElementById('columnInputs').appendChild(field);
                    j +=1;
                }
            }

            function addValue(){ // Adding values entered in fields to relevant columns
                chart.data.datasets[0].data[(this.id.slice(-1))-1]=0;
                let v = document.getElementById(this.id).value;
                let z = chart.data.datasets[0].data[(this.id.slice(-1))-1];
                chart.data.datasets[0].data[(this.id.slice(-1))-1]=z+v;
                chart.update(); 
            }
            
        </script>
    </body>
</html>